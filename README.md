# Учебное пособие по лучевой диагностике рака прямой кишки

## Описание проекта

Данный проект представляет собой учебное пособие по лучевой диагностике рака прямой кишки, написанное в формате Markdown. Книга содержит систематизированную информацию о диагностике, стадировании и методах исследования рака прямой кишки.

## Структура проекта

```
RectumRadioBook/
├── README.md                          # Данный файл
├── CLAUDE.md                         # Инструкции для редактирования
├── mdsplit.py                        # Утилита для разделения MD файлов
├── build/                            # Скомпилированные файлы
├── styles/                           # Стили оформления
├── img/                              # Изображения
│   └── media/                        # Медиафайлы (image1.png - image70.png)
└── src/                              # Исходные файлы книги
    ├── Introduction.md                   # Введение в проблематику
    ├── Research-Methodology.md      # Методики исследования
    ├── Rectum-Anatomy.md      # Анатомия прямой кишки
    │   ├── Строение-стенки.md        # Строение стенки кишки
    │   ├── Отношение-к-брюшине.md    # Отношение к брюшине
    │   └── Мезоректальная-фасция.md  # Мезоректальная фасция
    ├── Tumor-Detection.md          # Выявление опухоли
    │   └── Classification.md          # Классификация опухолей
    ├── Rectal-Cancer-Staging.md # Стадирование рака
    │   ├── T-Staging.md         # Т-стадирование
    │   ├── N-Staging.md         # N-стадирование
    │   ├── Local-Extent-Assessment.md
    │   ├── Circumferential-Resection-Margin-Assessment.md
    │   └── Extramural-Venous-Invasion-Assessment.md
    ├── Structured-Report-Primary-MRI-Staging.md
    └── Bibliography.md          # Библиография
```

## Содержание книги

### 1. Введение
Основы понимания рака прямой кишки, эпидемиология и общие принципы диагностики.

### 2. Анатомия прямой кишки
- **Строение стенки** - детальное описание слоев стенки кишки
- **Отношение к брюшине** - анатомические особенности расположения
- **Мезоректальная фасция** - важные анатомические структуры для стадирования

### 3. Методика исследования
Протоколы и методики проведения лучевых исследований.

### 4. Выявление опухоли
- **Классификация** - типы опухолей и их характеристики

### 5. Стадирование рака прямой кишки
- **Т-стадирование** - оценка глубины инвазии опухоли
- **N-стадирование** - оценка поражения лимфатических узлов
- **Оценка местной распространенности** - локальная инвазия
- **Оценка циркулярного края резекции** - важный прогностический фактор
- **Оценка экстрамуральной венозной инвазии** - сосудистая инвазия

### 6. Структурированный отчет при первичном МРТ-стадировании РПК
Стандартизированный подход к описанию результатов МРТ-исследований.

### 7. Список литературы
Библиографические ссылки в формате CSL JSON.

## Технические особенности

### Инструменты
- **mdsplit.py** - Python скрипт для разделения больших Markdown файлов на отдельные главы
- **CLAUDE.md** - содержит инструкции для автоматизированного редактирования с помощью ИИ

### Workflow для изображений

Проект использует автоматизированную систему обработки аннотированных изображений на основе SVG файлов с применением CSS стилей.

#### Структура изображений
```
img/
├── anatomy/           # Анатомические иллюстрации
├── classification/    # Классификация опухолей  
├── methodology/       # Методики исследования
└── staging/          # Стадирование рака
    ├── crm/          # Циркулярный край резекции
    ├── emvi/         # Экстрамуральная венозная инвазия
    ├── measurement/  # Измерения
    └── t-staging/    # T-стадирование
```

#### Процесс обработки изображений

1. **Исходные файлы**: В каждой папке находятся:
   - Оригинальные изображения (`.png`, `.jpg`)
   - SVG файлы с векторными аннотациями (`annotation.svg`, `annotation_mri.svg`, `annotation_ct.svg`)

2. **Соглашения по именованию на разных стадиях обработки**:
   - **Исходные файлы**: `image1.png`
   - **Аннотированные SVG**: `annotation.svg` (без постфиксов)
   - **Стилизованные SVG**: `annotation_styled.svg` (постфикс `styled`) временный файл
   - **Финальные PNG**: `annotation_styled_annotated.png` (суффикс `annotated`) временный файл
   - **PNG из pre-render**: `_book/img/folder/annotation_styled_annotated.png` временный файл
   - **Аннотированные изображения**: `image1_annotated.png`

3. **Применение стилей**: CSS стили из `styles/annotation.css` автоматически применяются к SVG элементам на основе их слоев (layer names):
   - Анатомические слои: `mucosa`, `submucosa`, `muscularis`, `serosa`
   - Опухолевые структуры: `tumor`, `tumor_core`, `tumor_part`
   - Лимфатическая система: `lymph_node`, `lymph_node_necrosis`
   - Сосуды: `vessels`
   - Анатомические ориентиры: `dentate_line`, `sphincter`, `peritoneum`

4. **Автоматическая генерация**: При сборке книги через Quarto:
   - **Pre-render** (`scripts/prepare_images_prerender.py`):
     - Находит все SVG файлы с аннотациями по паттернам: `annotation.svg`, `annotation_mri.svg`, `annotation_ct.svg`, `annotatiom_mri.svg`
     - Применяет CSS стили к векторным элементам
     - Экспортирует стилизованные SVG в PNG через Inkscape
     - Копирует все изображения в директорию `_book/img/`
   - **Post-render** (`scripts/clean_generated_images.py`):
     - Удаляет временные файлы из исходных директорий
     - Оставляет только оригинальные файлы

5. **Ручная обработка** (опционально):
   ```bash
   python scripts/prepare_images.py --style annotation.css --folder ./img
   ```
   Этот скрипт может быть использован для:
   - Применения стилей к отдельным SVG файлам
   - Экспорта отдельных элементов из SVG по ID
   - Генерации изображений с контекстом и без

#### Требования
- **Inkscape** - должен быть установлен в системе для экспорта SVG в PNG
- **Python библиотеки**: lxml, pathlib

### Стиль оформления
- Текст написан в академическом стиле с использованием медицинской терминологии
- Все утверждения подкреплены ссылками на научную литературу
- Используется формат ссылок: [@author_shorttitle_year]

## Рекомендации по навигации

1. **Начните с введения** для понимания общих принципов
2. **Изучите анатомию** для понимания структурных основ
3. **Ознакомьтесь с методикой исследования** для практического применения
4. **Последовательно изучите разделы по стадированию** для систематического понимания
5. **Используйте структурированный отчет** как практический инструмент

## Для редакторов

При работе с текстом следуйте инструкциям в файле `CLAUDE.md`, которые обеспечивают:
- Единообразный академический стиль
- Корректное оформление ссылок
- Сохранение медицинской точности
- Логическую структуру изложения